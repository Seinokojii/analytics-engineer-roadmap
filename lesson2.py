import pandas as pd  # –ü–æ–¥–∫–ª—é—á–∞–µ–º Pandas - –Ω–∞—à–µ–≥–æ –≥–ª–∞–≤–Ω–æ–≥–æ –ø–æ–º–æ—â–Ω–∏–∫–∞
import time          # –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –∑–∞—Å–µ–∫–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
import os            # –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏ –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ

# 1. –°–æ–∑–¥–∞–µ–º –º–∞–ª–µ–Ω—å–∫—É—é —Ç–∞–±–ª–∏—Ü—É (DataFrame)
# –ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —ç—Ç–æ —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫
data = {
    '–¢–æ–≤–∞—Ä': ['–Ø–±–ª–æ–∫–æ', '–ë–∞–Ω–∞–Ω', '–ú–æ–ª–æ–∫–æ', '–•–ª–µ–±'] * 100000, # –£–º–Ω–æ–∂–∞–µ–º –Ω–∞ 100 000, —á—Ç–æ–±—ã –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞–ª–æ –º–Ω–æ–≥–æ
    '–¶–µ–Ω–∞': [100, 50, 80, 40] * 100000,
    '–ú–∞–≥–∞–∑–∏–Ω': ['–ü—è—Ç–µ—Ä–æ—á–∫–∞', '–ú–∞–≥–Ω–∏—Ç', '–ê—à–∞–Ω', '–õ–µ–Ω—Ç–∞'] * 100000
}
df = pd.DataFrame(data) # –ü—Ä–µ–≤—Ä–∞—â–∞–µ–º —Å–ª–æ–≤–∞—Ä—å –≤ —Ç–∞–±–ª–∏—Ü—É

print("–î–∞–Ω–Ω—ã–µ —Å–æ–∑–¥–∞–Ω—ã! –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫:", len(df))

# 2. –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ CSV (–°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–±)
print("–°–æ—Ö—Ä–∞–Ω—è—é –≤ CSV...")
start_time = time.time() # –ó–∞—Å–µ–∫–∞–µ–º –≤—Ä–µ–º—è
df.to_csv('data.csv', index=False)
print(f"CSV –≥–æ—Ç–æ–≤ –∑–∞ {time.time() - start_time:.2f} —Å–µ–∫—É–Ω–¥")

# 3. –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Parquet (–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–±)
print("–°–æ—Ö—Ä–∞–Ω—è—é –≤ Parquet...")
start_time = time.time()
# engine='pyarrow' ‚Äî —ç—Ç–æ —Ç–æ—Ç —Å–∞–º—ã–π –º–æ—Ç–æ—Ä—á–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –±—ã—Å—Ç—Ä–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å Parquet
df.to_parquet('data.parquet', engine='pyarrow') 
print(f"Parquet –≥–æ—Ç–æ–≤ –∑–∞ {time.time() - start_time:.2f} —Å–µ–∫—É–Ω–¥")

# 4. –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤
# –ú—ã –¥–µ–ª–∏–º –Ω–∞ 1024*1024, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –º–µ–≥–∞–±–∞–π—Ç—ã (–ú–ë)
size_csv = os.path.getsize('data.csv') / (1024 * 1024)
size_parquet = os.path.getsize('data.parquet') / (1024 * 1024)

print("-" * 30)
print(f"–†–∞–∑–º–µ—Ä CSV: {size_csv:.2f} MB")
print(f"–†–∞–∑–º–µ—Ä Parquet: {size_parquet:.2f} MB")
print("-" * 30)
 print("–í—ã–≤–æ–¥: Parquet –∑–∞–Ω–∏–º–∞–µ—Ç –º–µ–Ω—å—à–µ –º–µ—Å—Ç–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ! üéâ") 
# –ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —ç—Ç–æ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –ø–æ–ª—É—á–∏–ª–∏ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ (JSON)
complex_data = [
    {"id": 1, "info": {"name": "Ivan", "city": "Moscow"}},
    {"id": 2, "info": {"name": "Anna", "city": "Kazan"}},
    {"id": 3, "info": {"name": "Petr", "city": "Omsk"}}
]
# 1. –ó–∞–≥—Ä—É–∂–∞–µ–º "–∫–∞–∫ –µ—Å—Ç—å"
df_simple = pd.DataFrame(complex_data)
print("\n–ü—Ä–æ—Å—Ç–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ JSON (–Ω–µ–∫—Ä–∞—Å–∏–≤–æ):")
print(df_simple)

# 2. –ú–∞–≥–∏—è: "–†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º" –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (json_normalize)
# –≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç –∏–Ω–¥—É—Å—Ç—Ä–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å JSON
df_flat = pd.json_normalize(complex_data)
print("\n–†–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–π JSON (–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ):")
print(df_flat) 