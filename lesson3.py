import duckdb
import pandas as pd

# --- –¢–ï–û–†–ò–Ø: –ß–¢–û –¢–ê–ö–û–ï SQL? ---
# SQL (Structured Query Language) ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± –∑–∞–¥–∞–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã –¥–∞–Ω–Ω—ã–º. 
# –ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ‚Äî —ç—Ç–æ –æ—á–µ–Ω—å –ø–æ—Å–ª—É—à–Ω—ã–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å. 
# –¢—ã –Ω–µ –≥–æ–≤–æ—Ä–∏—à—å –µ–º—É, –ö–ê–ö –∏—Å–∫–∞—Ç—å –∫–Ω–∏–≥—É, —Ç—ã –≥–æ–≤–æ—Ä–∏—à—å, –ö–ê–ö–ê–Ø –∫–Ω–∏–≥–∞ —Ç–µ–±–µ –Ω—É–∂–Ω–∞.

print("üöÄ –ù–∞—á–∏–Ω–∞–µ–º —É—Ä–æ–∫ SQL!")

# –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–¥–∏–º –Ω–µ–º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –±—ã–ª–æ –Ω–∞ —á–µ–º —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è
data = {
    'item': ['iPhone', 'Samsung', 'MacBook', 'iPad', 'AirPods', 'Apple Watch'],
    'category': ['Phone', 'Phone', 'Laptop', 'Tablet', 'Audio', 'Wearable'],
    'price': [1000, 800, 2500, 600, 200, 400],
    'stock': [15, 20, 5, 10, 50, 30]
}
df = pd.DataFrame(data)
df.to_csv('inventory.csv', index=False)
print("‚úÖ –§–∞–π–ª inventory.csv —Å–æ–∑–¥–∞–Ω. –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–ø—Ä–æ—Å—ã...\n")

# --- –ü–†–ê–ö–¢–ò–ö–ê: –ó–ê–ü–†–û–°–´ ---

# 1. SELECT –∏ FROM (–í—ã–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö)
# SELECT ‚Äî —á—Ç–æ –ø–æ–∫–∞–∑–∞—Ç—å, FROM ‚Äî –æ—Ç–∫—É–¥–∞ –≤–∑—è—Ç—å.
print("--- –ó–ê–î–ê–ù–ò–ï 1: –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –∏ –∏—Ö —Ü–µ–Ω—ã ---")
query1 = "SELECT item, price FROM 'inventory.csv'"
print(duckdb.sql(query1).df())

# 2. WHERE (–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è)
# –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–æ–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏.
print("\n--- –ó–ê–î–ê–ù–ò–ï 2: –¢–æ–≤–∞—Ä—ã –¥–æ—Ä–æ–∂–µ 700$ (–î–æ—Ä–æ–≥–∏–µ —Ç–æ–≤–∞—Ä—ã) ---")
query2 = "SELECT * FROM 'inventory.csv' WHERE price > 700"
print(duckdb.sql(query2).df())

# 3. –ù–µ—Å–∫–æ–ª—å–∫–æ —É—Å–ª–æ–≤–∏–π (AND / OR)
print("\n--- –ó–ê–î–ê–ù–ò–ï 3: –¢–µ–ª–µ—Ñ–æ–Ω—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–æ—è—Ç –¥–µ—à–µ–≤–ª–µ 900$ ---")
query3 = "SELECT * FROM 'inventory.csv' WHERE category = 'Phone' AND price < 900"
print(duckdb.sql(query3).df())

# 4. ORDER BY (–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞)
# DESC ‚Äî –æ—Ç –±–æ–ª—å—à–µ–≥–æ –∫ –º–µ–Ω—å—à–µ–º—É, ASC ‚Äî –æ—Ç –º–µ–Ω—å—à–µ–≥–æ –∫ –±–æ–ª—å—à–µ–º—É.
print("\n--- –ó–ê–î–ê–ù–ò–ï 4: –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –Ω–∞ —Å–∫–ª–∞–¥–µ (–æ—Ç –º–∞–∫—Å–∏–º—É–º–∞) ---")
query4 = "SELECT item, stock FROM 'inventory.csv' ORDER BY stock DESC"
print(duckdb.sql(query4).df())

# 5. LIMIT (–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ)
# –ö–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã—Ö –º–∏–ª–ª–∏–æ–Ω—ã, –º—ã –±–µ—Ä–µ–º —Ç–æ–ª—å–∫–æ –≤–µ—Ä—Ö—É—à–∫—É.
print("\n--- –ó–ê–î–ê–ù–ò–ï 5: –¢–æ–ø-2 —Å–∞–º—ã—Ö –¥–æ—Ä–æ–≥–∏—Ö —Ç–æ–≤–∞—Ä–∞ ---")
query5 = "SELECT item, price FROM 'inventory.csv' ORDER BY price DESC LIMIT 2"
print(duckdb.sql(query5).df())